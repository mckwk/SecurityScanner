import tkinter as tk
from tkinter import ttk

class VulnerabilityDetailWindow:
    def __init__(self, parent, details):
        self.window = tk.Toplevel(parent)
        self.window.title(f"Details for {details['id']}")
        self.details = details
        self._setup_widgets()

    def _setup_widgets(self):
        self.window.geometry("600x500")
        
        frame = ttk.Frame(self.window, padding="10")
        frame.pack(fill=tk.BOTH, expand=True)

        ttk.Label(frame, text=f"Device Name: {self.details.get('device_name', 'Unknown')}", font=("Arial", 12, "bold")).pack(pady=5)
        ttk.Label(frame, text=f"CVE ID: {self.details['id']}", font=("Arial", 12, "bold")).pack(pady=5)
        ttk.Label(frame, text=f"Published: {self.details['published']}", font=("Arial", 12)).pack(pady=5)
        ttk.Label(frame, text=f"Last Modified: {self.details['last_modified']}", font=("Arial", 12)).pack(pady=5)
        ttk.Label(frame, text=f"Severity: {self.details['severity']}", font=("Arial", 12)).pack(pady=5)
        ttk.Label(frame, text=f"Impact Score: {self.details['impact_score']}", font=("Arial", 12)).pack(pady=5)
        ttk.Label(frame, text=f"Exploitability Score: {self.details['exploitability_score']}", font=("Arial", 12)).pack(pady=5)
        
        ttk.Label(frame, text="Description:", font=("Arial", 12, "bold")).pack(pady=5)
        description_text = tk.Text(frame, wrap=tk.WORD, height=5, width=70)
        description_text.insert(tk.END, self.details['description'])
        description_text.config(state=tk.DISABLED)
        description_text.pack(pady=5)

        ttk.Label(frame, text="References:", font=("Arial", 12, "bold")).pack(pady=5)
        references_text = tk.Text(frame, wrap=tk.WORD, height=5, width=70)
        for ref in self.details['references']:
            references_text.insert(tk.END, ref + "\n")
        references_text.config(state=tk.DISABLED)
        references_text.pack(pady=5)